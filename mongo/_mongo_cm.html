

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Mongo &mdash; my Cloudmesh Learning documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="author" title="About these documents"
              href="../about.html"/>
    <link rel="top" title="my Cloudmesh Learning documentation" href="../index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index.html" class="fa fa-home"> my Cloudmesh</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../preface.html">Preface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../preface.html#conventions">Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../preface.html#using-the-notebooks">Using the Notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about.html#independent-study-at-iu">Independent Study at IU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#student-employment-at-iu">Student Employment at IU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about.html#contributing-to-the-manual">Contributing to the Manual</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">Contact</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contact.html#contributors">Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contact.html#support">Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../resources.html">Resources from the Internet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../class/index.html">Cloudmesh in Classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../class/bdosp_sp15/index.html"> Spring 2015 - Big Data Open Source Software Project (BUEX-V 594)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../class/vc_sp15/index.html">Spring 2015 - Big Data Applications to Clouds and HPC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../class/i590.html">Fall 2014 - Big Data Applications and Analytics (<code class="docutils literal"><span class="pre">Info</span> <span class="pre">I590</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../class/cm-mooc/index.html">VM for Big Data Applications and Analytics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../class/lessons.html">Lessons</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../accounts/index.html">Cloud Accounts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../accounts/accounts.html">Creating FutureSystems Accounts and Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accounts/details.html">Account and Project Management</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cloudmesh/index.html">Cloudmesh</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cloudmesh/overview.html">Cloudmesh Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cloudmesh/setup/index.html">Cloudmesh Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cloudmesh/cm/index.html">Cloudmesh cm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cloudmesh/api/index.html">Cloudmesh API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cloudmesh/shell/index.html">Cloudmesh Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cloudmesh/gui/index.html">Cloudmesh GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cloudmesh/faq.html">Cloudmesh FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../parallel.html">Parallel Shell</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../parallel.html#parallel-distributed-shell-pdsh">Parallel Distributed Shell (pdsh)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel.html#fabric">Fabric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel.html#cloudmesh-parallel-api">Cloudmesh Parallel API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../parallel.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../iaas/index.html">IaaS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../iaas/index.html#openstack-clouds">OpenStack Clouds</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../paas/index.html">PaaS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../paas/hadoop.html">Using Hadoop in FutureSystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../paas/hadoop-setup.html">Deploying a Hadoop Cluster on India OpenStack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hpc/index.html">HPC</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hpc/hpc.html">HPC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/index.html">Hardware</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hardware/indiana.html">Hardware at Indiana University</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../devops/index.html">DevOps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../devops/history.html">Historical and Functionality Perspective</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devops/makefile.html">Makefile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devops/shell.html">Shell Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devops/configure.html">Configure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../devops/rpm.html">Package Managers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../ipython/index.html">IPython</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../ipython/_ipython.html">IPython</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../rst.html">reStructuredText</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../rst.html#sections">Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rst.html#listtable">Listtable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rst.html#exceltable">Exceltable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rst.html#boxes">Boxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rst.html#sidebar-directive">Sidebar directive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rst.html#autorun">Autorun</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rst.html#hyperlinks">Hyperlinks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rst.html#todo">Todo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../management/index.html">Create Cloudmesh Development Image</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../management/create_image.html">How to setup a Cloudmesh Image</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/index.html">Contribute to Cloudmesh</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contribute/python-programming-style.html">How to write good Python codes for Cloudmesh</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../todo.html">ToDos</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">my Cloudmesh</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
    <li>Mongo</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/mongo/_mongo_cm.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="mongo">
<h1>Mongo<a class="headerlink" href="#mongo" title="Permalink to this headline">¶</a></h1>
<button type="button" class="btn btn-default navbar-btn"><p><a class="reference external" href="http://localhost:8888/notebooks/docs/source/cloudmesh/api/_mongo_cm.ipynb">Notebook</a></p>
</button><p>In cloudmesh we used and support two kind of mongo client - mongoclient
from pymongo, and mongoengine. The first one create a connection to
mongo and raw queries from mongodb are performed directly. The second
one creates an object and data mapping, so, instead of query directly on
the database level, the program is supposed to deal with object, while
the object is mapped to the data layer automatically by the library.</p>
<p>While the first one gives the most flexibility and total power to
manipulating the db, in practise the second one provides better code
readability and easier maintenance. In either case, we provide factory
based connection generator in cloudmesh so it&#8217;s easy to get a handler to
deal with the db for cloudmesh developers.</p>
<div class="section" id="pymongo">
<h2>PyMongo<a class="headerlink" href="#pymongo" title="Permalink to this headline">¶</a></h2>
<p>the preferrable way is to use the cm_mongo wrapper.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cloudmesh.cm_mongo</span> <span class="kn">import</span> <span class="n">cm_mongo</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">cm_mongo</span><span class="p">()</span>
</pre></div>
</div>
<p>Then you can utilize the methods defined in cm to easily read/write
data.</p>
<p>In case the operation you need was not defiend in the cm_mongo, you can
either define it and augment the cm_mongo class (recommended), or
directly use a connection handler defined as member of the class to
directly talk to the db. (Not recommended)</p>
<p>If you are clear about which db you only need to connect, you can do
this also:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cloudmesh.config.cm_config</span> <span class="kn">import</span> <span class="n">get_mongo_db</span>
<span class="n">collection</span> <span class="o">=</span> <span class="s">&quot;cloudmesh&quot;</span>
<span class="n">dbconn</span> <span class="o">=</span> <span class="n">get_mongo_db</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>
</pre></div>
</div>
<p>This will connect you to the db specified by the key &#8216;cloudmesh&#8217; in the
mongodb section in the cloudmesh_server.yaml. Then dbconn is an object
of MongoClient from pymongo so you can carry on calls directly to the
db.</p>
</div>
<div class="section" id="mongoengine">
<h2>MongoEngine<a class="headerlink" href="#mongoengine" title="Permalink to this headline">¶</a></h2>
<p>If it&#8217;s possible, try to define classes for your data structure first
and then use MongoEngine to map them to the data layer.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cloudmesh.config.cm_config</span> <span class="kn">import</span> <span class="n">get_mongo_db</span><span class="p">,</span> <span class="n">DBConnFactory</span>
<span class="n">get_mongo_db</span><span class="p">(</span><span class="s">&quot;experiment&quot;</span><span class="p">,</span> <span class="n">DBConnFactory</span><span class="o">.</span><span class="n">TYPE_MONGOENGINE</span><span class="p">)</span>
</pre></div>
</div>
<p>This achieves what the connect() method is supposed to do, which is
defined in MongoEngine, but with the factory pattern. In this example,
it connect to the db keyed by &#8216;experiment&#8217; in the mongodb section in the
cloudmesh_server.yaml.</p>
<p>E.g., you can define a class for a data strucure, inheriting the
Document class:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ExperimentBase</span><span class="p">(</span><span class="n">Document</span><span class="p">):</span>
    <span class="n">cm_kind</span> <span class="o">=</span> <span class="n">StringField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="s">&quot;experiment&quot;</span><span class="p">)</span>
    <span class="n">cm_label</span> <span class="o">=</span> <span class="n">StringField</span><span class="p">()</span>
    <span class="n">cm_userid</span> <span class="o">=</span> <span class="n">StringField</span><span class="p">()</span>
    <span class="n">meta</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;allow_inheritance&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">}</span>
    <span class="n">get_mongo_db</span><span class="p">(</span><span class="s">&quot;experiment&quot;</span><span class="p">,</span> <span class="n">DBConnFactory</span><span class="o">.</span><span class="n">TYPE_MONGOENGINE</span><span class="p">)</span>
</pre></div>
</div>
<p>Then when you created object for this class, and a call .save() will
save the object to the specified db.</p>
<p>Please note each different class will be writen into the specified db as
a separate table/collection.</p>
</div>
</div>


          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013, myCloudmesh.org/learning.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'Learning',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>