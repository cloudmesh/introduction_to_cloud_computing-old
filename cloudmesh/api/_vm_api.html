

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Cloudmesh API for VM Management &mdash; my Cloudmesh Learning documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
        <link rel="author" title="About these documents"
              href="../../about.html"/>
    <link rel="top" title="my Cloudmesh Learning documentation" href="../../index.html"/>
        <link rel="up" title="Cloudmesh API" href="index.html"/>
        <link rel="next" title="Cloudmesh Mesh" href="_mesh.html"/>
        <link rel="prev" title="Batch Queues" href="_pbs.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="../../index.html" class="fa fa-home"> my Cloudmesh</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../preface.html">Preface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../preface.html#conventions">Conventions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../preface.html#using-the-notebooks">Using the Notebooks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#independent-study-at-iu">Independent Study at IU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#student-employment-at-iu">Student Employment at IU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../about.html#contributing-to-the-manual">Contributing to the Manual</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contact.html">Contact</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contact.html#contributors">Contributors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contact.html#support">Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../resources.html">Resources from the Internet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class/index.html">Cloudmesh in Classes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../class/lessons.html">Lessons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class/vc2_sp15/index.html">IU Spring 2015: Section II Practical Use of Big Data Software on OpenStack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class/vc_sp15/index.html">IU Spring 2015</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class/i590.html">IU Fall 2014 (Info I590)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../class/cm-mooc/index.html">Cloudmesh MOOC Shell</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../accounts/index.html">Cloud Accounts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../accounts/accounts.html">Creating FutureSystems Accounts and Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../accounts/details.html">Account and Project Management</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Cloudmesh</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Cloudmesh Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../setup/index.html">Cloudmesh Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cm/index.html">Cloudmesh cm</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Cloudmesh API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell/index.html">Cloudmesh Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gui/index.html">Cloudmesh GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../faq.html">Cloudmesh FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../parallel.html">Parallel Shell</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../parallel.html#parallel-distributed-shell-pdsh">Parallel Distributed Shell (pdsh)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../parallel.html#fabric">Fabric</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../parallel.html#cloudmesh-parallel-api">Cloudmesh Parallel API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../parallel.html#exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../iaas/index.html">IaaS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../iaas/index.html#openstack-clouds">OpenStack Clouds</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../paas/index.html">PaaS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../paas/hadoop.html">Using Hadoop in FutureSystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../paas/hadoop-setup.html">Deploying a Hadoop Cluster on India OpenStack</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../hpc/index.html">HPC</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../hpc/hpc.html">HPC</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../hardware/index.html">Hardware</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../hardware/indiana.html">Hardware at Indiana University</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html">DevOps</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../devops/history.html">Historical and Functionality Perspective</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../devops/makefile.html">Makefile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../devops/shell.html">Shell Scripts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../devops/configure.html">Configure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../devops/rpm.html">Package Managers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ipython/index.html">IPython</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ipython/_ipython.html">IPython</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rst.html">reStructuredText</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../rst.html#sections">Sections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst.html#listtable">Listtable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst.html#exceltable">Exceltable</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst.html#boxes">Boxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst.html#sidebar-directive">Sidebar directive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst.html#autorun">Autorun</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst.html#hyperlinks">Hyperlinks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../rst.html#todo">Todo</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../management/index.html">Create Cloudmesh Development Image</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../management/create_image.html">How to setup a Cloudmesh Image</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/index.html">Contribute to Cloudmesh</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contribute/python-programming-style.html">How to write good Python codes for Cloudmesh</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../todo.html">ToDos</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">my Cloudmesh</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Cloudmesh</a> &raquo;</li>
      
          <li><a href="index.html">Cloudmesh API</a> &raquo;</li>
      
    <li>Cloudmesh API for VM Management</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../../_sources/cloudmesh/api/_vm_api.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="cloudmesh-api-for-vm-management">
<h1>Cloudmesh API for VM Management<a class="headerlink" href="#cloudmesh-api-for-vm-management" title="Permalink to this headline">¶</a></h1>
<button type="button" class="btn btn-default navbar-btn"><p><a class="reference external" href="http://localhost:8888/notebooks/docs/source/cloudmesh/api/_vm_api.ipynb">Notebook</a></p>
</button><p>Cloudmesh supports the simple management of heterogeneous virtual
machines from a variety of cloud frameworks, including Openstack, Azure,
AWS, Eucalyptus and but also AWS compatible clouds. This page shows how
to use Cloudmesh functions in python by a couple of examples on starting
or stopping virtual machine instances through the APIs.</p>
<div class="section" id="initialization">
<h2>Initialization<a class="headerlink" href="#initialization" title="Permalink to this headline">¶</a></h2>
<p>A simple import allows you to enable all features of Cloudmesh in
Python.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">cloudmesh</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
</pre></div>
</div>
</div>
<div class="section" id="activating-clouds">
<h2>Activating Clouds<a class="headerlink" href="#activating-clouds" title="Permalink to this headline">¶</a></h2>
<p>Cloudmesh provides <em>yaml</em> or <em>mongo</em> option where to load basic
information. <em>yaml</em> relies on the yaml files in the $HOME/.cloudmesh
directory, <em>mongo</em> retrieves information from the mongo database.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">mesh</span> <span class="o">=</span> <span class="n">cloudmesh</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="s">&quot;mongo&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="get-a-username">
<h3>Get a username<a class="headerlink" href="#get-a-username" title="Permalink to this headline">¶</a></h3>
<p>In most Cloudmesh functions, you need to provide a username to tell the
server who is going to use cloud services.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">username</span> <span class="o">=</span> <span class="n">cloudmesh</span><span class="o">.</span><span class="n">load</span><span class="p">()</span><span class="o">.</span><span class="n">username</span><span class="p">()</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">username</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">gvonlasz</span>
</pre></div>
</div>
</div>
<div class="section" id="activate-the-user-account">
<h3>Activate the user account<a class="headerlink" href="#activate-the-user-account" title="Permalink to this headline">¶</a></h3>
<p>With the activation, the connection to IaaS cloud is established.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">mesh</span><span class="o">.</span><span class="n">activate</span><span class="p">(</span><span class="n">username</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>* india
Refreshing gvonlasz servers india -&gt;
Refresh time: 0.305170059204
Store time: 0.00300216674805
</pre></div>
</div>
</div>
<div class="section" id="register-a-cloud">
<h3>Register a cloud<a class="headerlink" href="#register-a-cloud" title="Permalink to this headline">¶</a></h3>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">cloudmesh</span><span class="o">.</span><span class="n">shell</span><span class="p">(</span><span class="s">&quot;cloud on india&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>* india
Refreshing gvonlasz servers india -&gt;
Refresh time: 0.282967090607
Store time: 0.00245690345764
[32mcloud &#39;india&#39; activated.[0m
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">cloudmesh</span><span class="o">.</span><span class="n">shell</span><span class="p">(</span><span class="s">&quot;cloud list&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>+-----------+--------+
| cloud     | active |
+-----------+--------+
| aws       |        |
| azure     |        |
| devstack  |        |
| dreamhost |        |
| hp        |        |
| hp_east   |        |
| india     | True   |
+-----------+--------+
</pre></div>
</div>
<p>Each cloud must have a default image and a default flavor to launch vm
instances in a simple step. default function provides a way to set
default values for an image o a flavor. In this example, we use <em>image</em>,
<em>flavor</em> variables which created from the examples above.</p>
</div>
<div class="section" id="need-a-help-for-the-function">
<h3>Need a help for the function?<a class="headerlink" href="#need-a-help-for-the-function" title="Permalink to this headline">¶</a></h3>
<p>You can execute a cell with a function name and a single question mark
(?) to see a short description of a function. A double question marks
(??) provide a source code with a docstring of the function. Try
<em>mesh.default?</em> or <em>mesh.default??</em></p>
</div>
</div>
<div class="section" id="get-flavors-or-images">
<h2>Get Flavors or Images<a class="headerlink" href="#get-flavors-or-images" title="Permalink to this headline">¶</a></h2>
<p>Cloudmesh retrieves information from a cache that need to be refreshed
in case you like to get the newest values. At the beginning you have to
call refresh so that he information from the cloud is populated into the
cache.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">mesh</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;flavors&#39;</span><span class="p">,</span> <span class="s">&#39;images&#39;</span><span class="p">],</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;india&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>* india
Refreshing gvonlasz flavors india -&gt;
Refresh time: 0.179011821747
Store time: 0.00220489501953
Refreshing gvonlasz images india -&gt;
Refresh time: 0.43066906929
Store time: 0.00897192955017
</pre></div>
</div>
<p>Available flavors can be listed with the following function.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">flavors</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">flavors</span><span class="p">(</span><span class="n">cm_user_id</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">clouds</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;india&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Let us display the names of the flavors</p>
<p>The functions about vm images provide an available vm images on a
selected cloud.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">flavors</span><span class="p">[</span><span class="s">&quot;india&quot;</span><span class="p">]:</span>
    <span class="k">print</span> <span class="n">flavors</span><span class="p">[</span><span class="s">&quot;india&quot;</span><span class="p">][</span><span class="nb">id</span><span class="p">][</span><span class="s">&quot;name&quot;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">m1</span><span class="o">.</span><span class="n">tiny</span>
<span class="n">m1</span><span class="o">.</span><span class="n">medium</span>
<span class="n">m1</span><span class="o">.</span><span class="n">small</span>
<span class="n">m1</span><span class="o">.</span><span class="n">xlarge</span>
<span class="n">m1</span><span class="o">.</span><span class="n">large</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">images</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">images</span><span class="p">(</span><span class="n">clouds</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;india&#39;</span><span class="p">],</span><span class="n">cm_user_id</span><span class="o">=</span><span class="n">username</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">images</span><span class="p">[</span><span class="s">&quot;india&quot;</span><span class="p">]:</span>
    <span class="k">print</span> <span class="n">images</span><span class="p">[</span><span class="s">&quot;india&quot;</span><span class="p">][</span><span class="nb">id</span><span class="p">][</span><span class="s">&quot;name&quot;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>salsahpc/cloud-mooc-m1-large-4GB
CentOS6
SL64-blank-sparse10gb-C vmdk
cglmoocs/ipython
futuregrid/centos-6
DaLiAna-vm2014e-geant4.10.vmdk Jan best
ubuntu-13.10
futuregrid/ubuntu-14.04
fg101/richieriee/my-ubuntu-01
sl64-gluex-vm2014e-40gb.vmdk Justin
futuregrid/fedora-19
fg10/jcharcal/centos6.5_x86_64
balewski/kernel-2.6.32-431.5.1-sl65
SL64-blank-sparse40GB vmdk
Ubuntu-12.04-blank2.vmdk
balewski/ramdisk-2.6.32-431.5.1-sl65
sl6_x64-qemu  french ?bad
balewski/sl6.5-blank-80gb-b works
grp17Cent
futuregrid/ubuntu-12.04
ndssl-vt/ubuntu-12.04-small
futuregrid/fedora-20
fg7/rynge/centos6-v1
ubuntu12-comet
balewski/daliana-vm2014e2-sl6.5-geant4.10-root5.34
DaLiAna-vm2014d-SL64-A.vmdk
</pre></div>
</div>
<div class="section" id="select-a-flavor">
<h3>Select a flavor<a class="headerlink" href="#select-a-flavor" title="Permalink to this headline">¶</a></h3>
<p>Flavor is also selectable. The selected image or flavor can be used to
set a default image or a default flavor.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">flavor</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">flavor</span><span class="p">(</span><span class="s">&#39;india&#39;</span><span class="p">,</span> <span class="s">&#39;m1.small&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="select-an-image">
<h3>Select an image<a class="headerlink" href="#select-an-image" title="Permalink to this headline">¶</a></h3>
<p>If you know the name of the vm image, you can specify the vm image to
user it later. In this example, we choose Ubuntu trusty 14.04 image.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">image</span><span class="o">=</span><span class="n">mesh</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="s">&#39;india&#39;</span><span class="p">,</span><span class="s">&#39;futuregrid/ubuntu-14.04&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="set-a-default-flavor-or-image">
<h2>Set a default flavor or image<a class="headerlink" href="#set-a-default-flavor-or-image" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">defaults</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="s">&#39;india&#39;</span><span class="p">,</span> <span class="s">&#39;image&#39;</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">defaults</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">default</span><span class="p">(</span><span class="s">&#39;india&#39;</span><span class="p">,</span> <span class="s">&#39;flavor&#39;</span><span class="p">,</span> <span class="n">flavor</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">pprint</span><span class="p">(</span><span class="n">defaults</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">u&#39;_id&#39;</span><span class="p">:</span> <span class="n">ObjectId</span><span class="p">(</span><span class="s">&#39;54242b0b6d8fecaafd838a11&#39;</span><span class="p">),</span>
 <span class="s">u&#39;activeclouds&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">u&#39;india&#39;</span><span class="p">],</span>
 <span class="s">u&#39;cm_user_id&#39;</span><span class="p">:</span> <span class="s">u&#39;gvonlasz&#39;</span><span class="p">,</span>
 <span class="s">u&#39;flavors&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">u&#39;india&#39;</span><span class="p">:</span> <span class="s">u&#39;2&#39;</span><span class="p">},</span>
 <span class="s">u&#39;group&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span>
 <span class="s">u&#39;images&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">u&#39;india&#39;</span><span class="p">:</span> <span class="s">u&#39;ba327564-5969-4309-b3f3-b67764038e66&#39;</span><span class="p">},</span>
 <span class="s">u&#39;index&#39;</span><span class="p">:</span> <span class="s">u&#39;41&#39;</span><span class="p">,</span>
 <span class="s">u&#39;key&#39;</span><span class="p">:</span> <span class="s">u&#39;flat-key&#39;</span><span class="p">,</span>
 <span class="s">u&#39;pagestatus&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">u&#39;india&#39;</span><span class="p">:</span> <span class="s">u&#39;true&#39;</span><span class="p">},</span>
 <span class="s">u&#39;prefix&#39;</span><span class="p">:</span> <span class="s">u&#39;gvonlasz&#39;</span><span class="p">,</span>
 <span class="s">u&#39;project&#39;</span><span class="p">:</span> <span class="s">u&#39;fg82&#39;</span><span class="p">,</span>
 <span class="s">u&#39;registered_clouds&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s">u&#39;india&#39;</span><span class="p">],</span>
 <span class="s">u&#39;securitygroup&#39;</span><span class="p">:</span> <span class="s">u&#39;development&#39;</span><span class="p">,</span>
 <span class="s">u&#39;shell_print_format&#39;</span><span class="p">:</span> <span class="s">u&#39;table&#39;</span><span class="p">}</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">image</span> <span class="o">=</span> <span class="s">&quot;futuregrid/ubuntu-14.04&quot;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">flavor</span> <span class="o">=</span> <span class="s">&quot;m1.small&quot;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">cloud</span> <span class="o">=</span> <span class="s">&quot;india&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="quick-start-a-vm">
<h2>Quick Start a VM<a class="headerlink" href="#quick-start-a-vm" title="Permalink to this headline">¶</a></h2>
<p>A simple function <em>start</em> provides a quick launch of vm instances in
cloudmesh.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">result</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="s">&quot;india&quot;</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">pprint</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&#39;cloud&#39;</span><span class="p">:</span> <span class="s">&#39;india&#39;</span><span class="p">,</span>
 <span class="s">&#39;cm_user_id&#39;</span><span class="p">:</span> <span class="s">&#39;gvonlasz&#39;</span><span class="p">,</span>
 <span class="s">&#39;flavor&#39;</span><span class="p">:</span> <span class="s">u&#39;m1.small&#39;</span><span class="p">,</span>
 <span class="s">&#39;flavor_id&#39;</span><span class="p">:</span> <span class="s">u&#39;2&#39;</span><span class="p">,</span>
 <span class="s">&#39;image&#39;</span><span class="p">:</span> <span class="s">u&#39;futuregrid/ubuntu-14.04&#39;</span><span class="p">,</span>
 <span class="s">&#39;image_id&#39;</span><span class="p">:</span> <span class="s">u&#39;ba327564-5969-4309-b3f3-b67764038e66&#39;</span><span class="p">,</span>
 <span class="s">&#39;key&#39;</span><span class="p">:</span> <span class="s">u&#39;gvonlasz_flat-key&#39;</span><span class="p">,</span>
 <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">u&#39;gvonlasz_41&#39;</span><span class="p">,</span>
 <span class="s">u&#39;server&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">u&#39;OS-DCF:diskConfig&#39;</span><span class="p">:</span> <span class="s">u&#39;MANUAL&#39;</span><span class="p">,</span>
             <span class="s">u&#39;adminPass&#39;</span><span class="p">:</span> <span class="s">u&#39;J6fnixrXGk5e&#39;</span><span class="p">,</span>
             <span class="s">u&#39;id&#39;</span><span class="p">:</span> <span class="s">u&#39;7547ecc9-61b8-42a4-9dac-0064a7407a63&#39;</span><span class="p">,</span>
             <span class="s">u&#39;links&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s">u&#39;href&#39;</span><span class="p">:</span> <span class="s">u&#39;http://149.165.146.57:8774/v1.1/8bc7e259464944b3bf4d8b050d1ab935/servers/7547ecc9-61b8-42a4-9dac-0064a7407a63&#39;</span><span class="p">,</span>
                         <span class="s">u&#39;rel&#39;</span><span class="p">:</span> <span class="s">u&#39;self&#39;</span><span class="p">},</span>
                        <span class="p">{</span><span class="s">u&#39;href&#39;</span><span class="p">:</span> <span class="s">u&#39;http://149.165.146.57:8774/8bc7e259464944b3bf4d8b050d1ab935/servers/7547ecc9-61b8-42a4-9dac-0064a7407a63&#39;</span><span class="p">,</span>
                         <span class="s">u&#39;rel&#39;</span><span class="p">:</span> <span class="s">u&#39;bookmark&#39;</span><span class="p">}],</span>
             <span class="s">u&#39;security_groups&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s">u&#39;name&#39;</span><span class="p">:</span> <span class="s">u&#39;default&#39;</span><span class="p">}]}}</span>
</pre></div>
</div>
</div>
<div class="section" id="delete-vm">
<h2>Delete VM<a class="headerlink" href="#delete-vm" title="Permalink to this headline">¶</a></h2>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">server</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s">&#39;server&#39;</span><span class="p">][</span><span class="s">&#39;id&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">mesh</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">cloud</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&#39;release_unused_public_ips&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">&#39;vm_delete&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;msg&#39;</span><span class="p">:</span> <span class="s">&#39;success&#39;</span><span class="p">}}</span>
</pre></div>
</div>
<p>If you know the id of the virtual machine that you want to destroy,
<em>delete</em> function in cloudmesh simply terminate the instance. This
example deletes the vm that we just launched above by getting the id
from the result dict.</p>
</div>
<div class="section" id="start-a-vm">
<h2>Start a VM<a class="headerlink" href="#start-a-vm" title="Permalink to this headline">¶</a></h2>
<p>Now let us see how to start VMs on a cloud, here is how to start a VM on
cloud india.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">result</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">start</span><span class="p">(</span><span class="n">cloud</span><span class="o">=</span><span class="n">cloud</span><span class="p">,</span>
                    <span class="n">cm_user_id</span><span class="o">=</span><span class="n">username</span><span class="p">,</span>
                    <span class="n">flavor</span><span class="o">=</span><span class="n">flavor</span><span class="p">,</span>
                    <span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
<p>You may don’t know what images or flavors are available on the cloud, or
you don’t want to type a long line every time you start a VM, things can
get a lot easier by performing some setting up.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">pprint</span> <span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&#39;cloud&#39;</span><span class="p">:</span> <span class="s">&#39;india&#39;</span><span class="p">,</span>
 <span class="s">&#39;cm_user_id&#39;</span><span class="p">:</span> <span class="s">&#39;gvonlasz&#39;</span><span class="p">,</span>
 <span class="s">&#39;flavor&#39;</span><span class="p">:</span> <span class="s">u&#39;m1.small&#39;</span><span class="p">,</span>
 <span class="s">&#39;flavor_id&#39;</span><span class="p">:</span> <span class="s">u&#39;2&#39;</span><span class="p">,</span>
 <span class="s">&#39;image&#39;</span><span class="p">:</span> <span class="s">u&#39;futuregrid/ubuntu-14.04&#39;</span><span class="p">,</span>
 <span class="s">&#39;image_id&#39;</span><span class="p">:</span> <span class="s">u&#39;ba327564-5969-4309-b3f3-b67764038e66&#39;</span><span class="p">,</span>
 <span class="s">&#39;key&#39;</span><span class="p">:</span> <span class="s">u&#39;gvonlasz_flat-key&#39;</span><span class="p">,</span>
 <span class="s">&#39;name&#39;</span><span class="p">:</span> <span class="s">u&#39;gvonlasz_42&#39;</span><span class="p">,</span>
 <span class="s">u&#39;server&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">u&#39;OS-DCF:diskConfig&#39;</span><span class="p">:</span> <span class="s">u&#39;MANUAL&#39;</span><span class="p">,</span>
             <span class="s">u&#39;adminPass&#39;</span><span class="p">:</span> <span class="s">u&#39;ETrauXf83o7M&#39;</span><span class="p">,</span>
             <span class="s">u&#39;id&#39;</span><span class="p">:</span> <span class="s">u&#39;45b70984-12e1-40ec-a809-f46923ee3eac&#39;</span><span class="p">,</span>
             <span class="s">u&#39;links&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s">u&#39;href&#39;</span><span class="p">:</span> <span class="s">u&#39;http://149.165.146.57:8774/v1.1/8bc7e259464944b3bf4d8b050d1ab935/servers/45b70984-12e1-40ec-a809-f46923ee3eac&#39;</span><span class="p">,</span>
                         <span class="s">u&#39;rel&#39;</span><span class="p">:</span> <span class="s">u&#39;self&#39;</span><span class="p">},</span>
                        <span class="p">{</span><span class="s">u&#39;href&#39;</span><span class="p">:</span> <span class="s">u&#39;http://149.165.146.57:8774/8bc7e259464944b3bf4d8b050d1ab935/servers/45b70984-12e1-40ec-a809-f46923ee3eac&#39;</span><span class="p">,</span>
                         <span class="s">u&#39;rel&#39;</span><span class="p">:</span> <span class="s">u&#39;bookmark&#39;</span><span class="p">}],</span>
             <span class="s">u&#39;security_groups&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s">u&#39;name&#39;</span><span class="p">:</span> <span class="s">u&#39;default&#39;</span><span class="p">}]}}</span>
</pre></div>
</div>
</div>
<div class="section" id="more-options-to-launch-a-vm-instance">
<h2>More options to launch a VM instance<a class="headerlink" href="#more-options-to-launch-a-vm-instance" title="Permalink to this headline">¶</a></h2>
<p>When you create a new VM instance, you can also choose multiple options
such as a flavor, an image, or a key associated with the instance.
<em>start()</em> function accepts keyword parameters as a user input of these
options. To see a brief description of the function, try <em>mesh.start?</em>
in the IPython Notebook cell.</p>
<p>Available options are: with * <tt class="docutils literal"><span class="pre">cloud</span></tt>: cloud id e.g. india *
<tt class="docutils literal"><span class="pre">cm_user_id</span></tt>: portal user id * <tt class="docutils literal"><span class="pre">prefix</span></tt>: The VM instance name
starts * <tt class="docutils literal"><span class="pre">index</span></tt>: The number of vm instances (auto increment), if you
set this make sure it is higher than the last index, as it will aslo set
the default index * <tt class="docutils literal"><span class="pre">flavor</span></tt>: flavor name e.g. m1.small * <tt class="docutils literal"><span class="pre">image</span></tt>:
image name e.g. futuregrid/ubuntu-14.04 * <tt class="docutils literal"><span class="pre">key</span></tt>: key name to use *
<tt class="docutils literal"><span class="pre">meta</span></tt>: data in python dict e.g. {&#8220;cm_user_id&#8221;: username}</p>
<p><tt class="docutils literal"><span class="pre">result</span> <span class="pre">=</span> <span class="pre">mesh.start(&quot;india&quot;,</span> <span class="pre">username,</span> <span class="pre">prefix=username)</span></tt></p>
</div>
<div class="section" id="vitual-machine-name">
<h2>Vitual Machine Name<a class="headerlink" href="#vitual-machine-name" title="Permalink to this headline">¶</a></h2>
<p>In Cloudmesh, the default VM name consists of your username and an auto
incremented number, for example, <em>alex_1</em>. Couple of functions allow
you to manage or modify the VM name as you wish.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">mesh</span><span class="o">.</span><span class="n">vmname</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="s">u&#39;gvonlasz_43&#39;</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">vmname()</span></tt> without parameters returns the current VM name that you can
use.</p>
<p>If you want to use a different name, you can specify prefix=&#8217;&#8217; and
idx=&#8217;&#8217; as parameters. However be aware that using this will also reset
the default values. Thus if you specify a number that is smaller than
the current number in the vms, you may overwrite in time the previos
name and end up with duplicated names.</p>
<p><tt class="docutils literal"><span class="pre">mesh.vmname(username,</span> <span class="pre">10)</span></tt></p>
<p>vmname_next() returns a VM name with an increased index number.</p>
<p><tt class="docutils literal"><span class="pre">mesh.vmname_next()</span></tt></p>
<p>There are some tricks to update the index number in <em>vmname()</em> function.</p>
<p><tt class="docutils literal"><span class="pre">mesh.vmname(username,</span> <span class="pre">&quot;+5&quot;)</span></tt></p>
</div>
<div class="section" id="assign-a-public-ip-address-to-the-vm">
<h2>Assign a public IP address to the VM<a class="headerlink" href="#assign-a-public-ip-address-to-the-vm" title="Permalink to this headline">¶</a></h2>
<p>assign_public_ip() function obtains a public IP address and assign it
to the VM.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">server</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s">&#39;server&#39;</span><span class="p">][</span><span class="s">&#39;id&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">pprint</span> <span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="s">u&#39;gvonlasz_42&#39;</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">ip</span><span class="o">=</span><span class="n">mesh</span><span class="o">.</span><span class="n">assign_public_ip</span><span class="p">(</span><span class="s">&#39;india&#39;</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">username</span><span class="p">)</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">ip</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>149.165.158.31
</pre></div>
</div>
</div>
<div class="section" id="ssh-to-the-vm">
<h2>SSH to the VM<a class="headerlink" href="#ssh-to-the-vm" title="Permalink to this headline">¶</a></h2>
<p>Once you obtained the public ip address, you can execute a test command
via SSH to the VM. You can use wait() function with retry options.
Otherwise, you can simply use ssh_execute() function.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">result</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">ipaddr</span><span class="o">=</span><span class="n">ip</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">retry</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>0 try to execute via ssh...
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">print</span> <span class="n">result</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="bp">True</span>
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">mesh</span><span class="o">.</span><span class="n">ssh_execute</span><span class="p">(</span><span class="n">ipaddr</span><span class="o">=</span><span class="n">ip</span><span class="p">,</span> <span class="n">command</span><span class="o">=</span><span class="s">&quot;uname -a&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>Linux gvonlasz-42 3.13.0-35-generic #62-Ubuntu SMP Fri Aug 15 01:58:42 UTC 2014 x86_64 x86_64 x86_64 GNU/Linux
</pre></div>
</div>
<p>added previously added to your known host file. in that case you must
remove it first from the ~/.ssh/known_hosts file.</p>
</div>
<div class="section" id="refreshing-vm-status">
<h2>Refreshing VM status<a class="headerlink" href="#refreshing-vm-status" title="Permalink to this headline">¶</a></h2>
<p>The information of VM instances can be displayed with <tt class="docutils literal"><span class="pre">servers()</span></tt>
function.</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">mesh</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;india&quot;</span><span class="p">],</span><span class="n">types</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;servers&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre>* india
Refreshing gvonlasz servers india -&gt;
Refresh time: 0.351860046387
Store time: 0.00319504737854
</pre></div>
</div>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">for</span> <span class="n">serverid</span> <span class="ow">in</span> <span class="n">mesh</span><span class="o">.</span><span class="n">servers</span><span class="p">(</span><span class="n">clouds</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;india&quot;</span><span class="p">],</span><span class="n">cm_user_id</span><span class="o">=</span><span class="n">username</span><span class="p">)[</span><span class="s">&quot;india&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">server</span> <span class="o">=</span>  <span class="n">mesh</span><span class="o">.</span><span class="n">servers</span><span class="p">(</span><span class="n">clouds</span><span class="o">=</span><span class="p">[</span><span class="s">&quot;india&quot;</span><span class="p">],</span><span class="n">cm_user_id</span><span class="o">=</span><span class="n">username</span><span class="p">)[</span><span class="s">&quot;india&quot;</span><span class="p">][</span><span class="n">serverid</span><span class="p">]</span>
    <span class="k">print</span> <span class="n">server</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="n">gvonlasz_39</span>
<span class="n">gvonlasz_42</span>
<span class="n">gvonlasz_38</span>
<span class="n">gvonlasz_40</span>
<span class="n">gvonlasz</span><span class="o">-</span><span class="mo">001</span>
<span class="n">gvonlasz_38</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="_mesh.html" class="btn btn-neutral float-right" title="Cloudmesh Mesh"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="_pbs.html" class="btn btn-neutral" title="Batch Queues"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2013, myCloudmesh.org/learning.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'Learning',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>